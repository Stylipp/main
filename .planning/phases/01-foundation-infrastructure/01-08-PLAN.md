---
phase: 01-foundation-infrastructure
plan: 08
type: execute
depends_on: ["01-01", "01-02", "01-03"]
files_modified: [.github/workflows/ci.yml, .husky/pre-commit, package.json, .lintstagedrc.json]
---

<objective>
Set up GitHub Actions CI/CD workflow for linting and testing, plus Husky pre-commit hooks for code quality.

Purpose: Automate code quality checks on every commit and push to prevent broken code from reaching production. Pre-commit hooks catch issues locally, GitHub Actions provides CI safety net for collaboration.
Output: GitHub Actions workflow running on push/PR, Husky pre-commit hooks running ESLint and Prettier, automated quality gates established.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-infrastructure/01-01-SUMMARY.md
@.planning/phases/01-foundation-infrastructure/01-02-SUMMARY.md
@.planning/phases/01-foundation-infrastructure/01-03-SUMMARY.md

**Repository**: https://github.com/Stylipp/main
**CI scope**: Lint frontend, type-check TypeScript, lint backend (Python), run tests (when added)
**Pre-commit scope**: ESLint, Prettier on staged files only
**Branches**: main (protected with required checks in future)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GitHub Actions CI workflow</name>
  <files>.github/workflows/ci.yml</files>
  <action>
    Create .github/workflows/ci.yml:

    **Name**: CI
    **Triggers**: push (all branches), pull_request (to main)
    **Jobs**:

    **frontend-lint:**
    - runs-on: ubuntu-latest
    - steps:
      - checkout@v4
      - setup-node@v4 with node-version: 20
      - Install pnpm: uses pnpm/action-setup@v2 with version: 8
      - pnpm install --frozen-lockfile
      - cd apps/web && pnpm lint (ESLint)
      - cd apps/web && pnpm type-check (add script: "type-check": "tsc --noEmit")

    **backend-lint:**
    - runs-on: ubuntu-latest
    - steps:
      - checkout@v4
      - setup-python@v5 with python-version: "3.12"
      - pip install ruff black (or flake8/pylint if preferred)
      - cd apps/backend && ruff check . (Python linting)
      - cd apps/backend && black --check . (Python formatting)

    **Note**: Tests job will be added in later phases when tests exist

    Set concurrency group to cancel in-progress runs on new push:
    - concurrency:
        group: ${{ github.workflow }}-${{ github.ref }}
        cancel-in-progress: true
  </action>
  <verify>.github/workflows/ci.yml exists, workflow validates with actionlint (if available) or GitHub web interface</verify>
  <done>GitHub Actions CI workflow created with frontend and backend lint jobs, runs on push and PR</done>
</task>

<task type="auto">
  <name>Task 2: Set up Husky with pre-commit hooks</name>
  <files>package.json, .husky/pre-commit, .husky/_/.gitignore</files>
  <action>
    Install Husky at workspace root:
    `pnpm add -D -w husky`

    Initialize Husky:
    `pnpm exec husky init`

    Update root package.json scripts:
    - "prepare": "husky install" (auto-runs on pnpm install)

    Create .husky/pre-commit:
    ```bash
    #!/usr/bin/env sh
    . "$(dirname -- "$0")/_/husky.sh"

    pnpm lint-staged
    ```

    Make executable: `chmod +x .husky/pre-commit`

    Add lint-staged script to root package.json:
    - "lint-staged": "lint-staged"
  </action>
  <verify>.husky/pre-commit exists and is executable (ls -l shows +x), package.json has prepare script</verify>
  <done>Husky installed and configured, pre-commit hook runs lint-staged on git commit</done>
</task>

<task type="auto">
  <name>Task 3: Configure lint-staged for automated checks</name>
  <files>.lintstagedrc.json, apps/web/package.json</files>
  <action>
    Install lint-staged:
    `pnpm add -D -w lint-staged`

    Install ESLint and Prettier for frontend:
    `cd apps/web && pnpm add -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin prettier eslint-config-prettier`

    Create .lintstagedrc.json at root:
    ```json
    {
      "apps/web/**/*.{ts,tsx}": [
        "eslint --fix",
        "prettier --write"
      ],
      "apps/web/**/*.{json,css,md}": [
        "prettier --write"
      ],
      "apps/backend/**/*.py": [
        "ruff check --fix",
        "black"
      ]
    }
    ```

    Create apps/web/.eslintrc.json:
    - extends: ["eslint:recommended", "plugin:@typescript-eslint/recommended", "prettier"]
    - parser: @typescript-eslint/parser
    - plugins: ["@typescript-eslint"]

    Create apps/web/.prettierrc:
    - semi: false
    - singleQuote: true
    - trailingComma: "es5"
    - printWidth: 100

    Update apps/web/package.json scripts:
    - "lint": "eslint src --ext ts,tsx"
    - "lint:fix": "eslint src --ext ts,tsx --fix"
    - "format": "prettier --write \"src/**/*.{ts,tsx,json,css,md}\""
    - "type-check": "tsc --noEmit"

    Test: Make a change, stage it, run `git commit` - should run lint-staged
  </action>
  <verify>git commit triggers lint-staged, ESLint and Prettier run on staged files, .lintstagedrc.json defines patterns for TS and Python files</verify>
  <done>lint-staged configured with ESLint, Prettier for frontend and ruff, black for backend; pre-commit hooks enforce code quality</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] .github/workflows/ci.yml exists with frontend-lint and backend-lint jobs
- [ ] Husky installed: .husky/pre-commit executable
- [ ] lint-staged configured: .lintstagedrc.json defines file patterns
- [ ] ESLint and Prettier installed in apps/web
- [ ] Test commit triggers pre-commit hook and runs linters
- [ ] Push to GitHub triggers CI workflow (check Actions tab)
- [ ] apps/web/package.json has lint, format, type-check scripts
</verification>

<success_criteria>

- GitHub Actions workflow runs on push and PR
- Frontend lint (ESLint) and type-check (TypeScript) jobs pass
- Backend lint (ruff/black) job passes
- Husky pre-commit hooks run lint-staged
- Staged files auto-formatted with ESLint and Prettier
- Code quality automated for solo developer workflow
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-infrastructure/01-08-SUMMARY.md`:

# Phase 1 Plan 8: CI/CD & Git Hooks Summary

**Set up GitHub Actions CI/CD workflow and Husky pre-commit hooks for automated code quality**

## Accomplishments

- Created GitHub Actions CI workflow with frontend and backend lint jobs
- Installed and configured Husky for Git hooks
- Set up lint-staged with ESLint, Prettier, ruff, black
- Added pre-commit hook to run linters on staged files
- Configured ESLint and Prettier for React/TypeScript

## Files Created/Modified

- `.github/workflows/ci.yml` - CI workflow for linting
- `.husky/pre-commit` - Pre-commit hook script
- `.lintstagedrc.json` - lint-staged file patterns and commands
- `apps/web/.eslintrc.json` - ESLint configuration for frontend
- `apps/web/.prettierrc` - Prettier configuration
- Updated `package.json` - Added prepare, lint-staged scripts
- Updated `apps/web/package.json` - Added lint, format, type-check scripts

## Decisions Made

- Using ruff + black for Python (faster than flake8/pylint)
- ESLint + Prettier for TypeScript (industry standard)
- lint-staged for performance (only checks staged files)
- Husky for Git hooks (cross-platform compatibility)
- Concurrency group cancels in-progress CI on new push

## Issues Encountered

None

## Next Step

Ready for 01-09-PLAN.md (i18n Scaffolding)
</output>
