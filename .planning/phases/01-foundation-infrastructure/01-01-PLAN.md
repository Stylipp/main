---
phase: 01-foundation-infrastructure
plan: 01
type: execute
depends_on: []
files_modified: [package.json, pnpm-workspace.yaml, tsconfig.base.json, .gitignore, .npmrc]
---

<objective>
Initialize pnpm monorepo with workspace structure for Stylipp.

Purpose: Establish the foundational monorepo architecture that all other services depend on. This sets up workspace boundaries, TypeScript config inheritance, and package management conventions.
Output: Working pnpm workspace with apps/, packages/, and infra/ structure ready for service development.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Project name**: Stylipp
**Domain**: stylipp.com
**Monorepo structure**: pnpm workspaces
**Apps**: web (React PWA), backend (FastAPI)
**Packages**: shared (TypeScript types/constants)
**Infrastructure**: Docker Compose, CI/CD configs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize pnpm workspace with root package.json</name>
  <files>package.json, pnpm-workspace.yaml, .npmrc</files>
  <action>
    Create root package.json with name "stylipp", private: true, and workspace scripts (dev, build, lint, test).
    Create pnpm-workspace.yaml defining workspace packages: ["apps/*", "packages/*"].
    Create .npmrc with shamefully-hoist=true and strict-peer-dependencies=false for MUI compatibility.
    Initialize pnpm: Run `pnpm install` to create pnpm-lock.yaml.
  </action>
  <verify>pnpm list shows workspace structure, pnpm-lock.yaml exists</verify>
  <done>Root package.json configured, pnpm-workspace.yaml defines apps/packages patterns, .npmrc configured, pnpm-lock.yaml generated</done>
</task>

<task type="auto">
  <name>Task 2: Create workspace directory structure</name>
  <files>apps/.gitkeep, packages/.gitkeep, infra/.gitkeep</files>
  <action>
    Create directory structure:
    - apps/ (will contain web/ and backend/)
    - packages/ (will contain shared/)
    - infra/ (will contain docker-compose.yml, traefik configs)

    Add .gitkeep files to ensure empty directories are tracked.
    Update root .gitignore with common patterns: node_modules/, dist/, build/, .env, .env.local, *.log, .DS_Store, coverage/, .vscode/, .idea/.
  </action>
  <verify>ls -la shows apps/, packages/, infra/ directories; .gitignore exists with node_modules entry</verify>
  <done>Directory structure created, .gitignore configured with standard patterns</done>
</task>

<task type="auto">
  <name>Task 3: Set up TypeScript config inheritance</name>
  <files>tsconfig.base.json</files>
  <action>
    Create tsconfig.base.json at root with shared compiler options:
    - target: ES2022
    - module: ESNext
    - moduleResolution: bundler
    - strict: true
    - esModuleInterop: true
    - skipLibCheck: true
    - resolveJsonModule: true
    - isolatedModules: true
    - jsx: react-jsx (for React workspaces)

    This will be extended by apps/web/tsconfig.json and packages/shared/tsconfig.json.
    Backend (Python) doesn't use this but keeping monorepo consistency.
  </action>
  <verify>cat tsconfig.base.json shows compilerOptions with strict: true and target: ES2022</verify>
  <done>tsconfig.base.json created with shared TypeScript config for workspaces to extend</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm --version` works (v8+)
- [ ] `pnpm list` shows workspace structure
- [ ] Root package.json has "private": true
- [ ] pnpm-workspace.yaml exists with apps/* and packages/*
- [ ] Directory structure: apps/, packages/, infra/ exist
- [ ] .gitignore contains node_modules/, .env patterns
- [ ] tsconfig.base.json has strict: true
</verification>

<success_criteria>

- pnpm workspace initialized with lock file
- Workspace structure (apps/, packages/, infra/) created
- TypeScript base config ready for extension
- .gitignore configured with standard patterns
- No errors from pnpm install
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-infrastructure/01-01-SUMMARY.md`:

# Phase 1 Plan 1: Monorepo & Workspace Setup Summary

**Initialized pnpm monorepo for Stylipp with workspace structure and TypeScript config inheritance**

## Accomplishments

- Created pnpm workspace with apps/*, packages/* patterns
- Established directory structure for web, backend, shared packages
- Configured TypeScript base config for workspace inheritance
- Set up .gitignore and .npmrc with best practices

## Files Created/Modified

- `package.json` - Root workspace config
- `pnpm-workspace.yaml` - Workspace package patterns
- `.npmrc` - pnpm configuration
- `tsconfig.base.json` - Shared TypeScript config
- `.gitignore` - Git ignore patterns
- `apps/`, `packages/`, `infra/` - Directory structure

## Decisions Made

- Using pnpm workspaces (not npm/yarn) for faster installs and strict dependency resolution
- shamefully-hoist=true for MUI compatibility
- TypeScript target ES2022 for modern JavaScript features

## Issues Encountered

None

## Next Step

Ready for 01-02-PLAN.md (Frontend Bootstrap)
</output>
